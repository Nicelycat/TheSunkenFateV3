<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FATE V3 - Games</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="shortcut icon" href="media/logo.svg" type="image/x-icon" />
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap");
      
      :root {
        --primary: #6366f1;
        --primary-glow: rgba(99, 102, 241, 0.5);
        --secondary: #8b5cf6;
        --accent: #06b6d4;
        --accent-glow: rgba(6, 182, 212, 0.4);
        --bg-deep: #0a0a0f;
        --bg-surface: rgba(15, 15, 25, 0.7);
        --glass: rgba(255, 255, 255, 0.03);
        --glass-border: rgba(255, 255, 255, 0.08);
        --text: #f8fafc;
        --text-muted: #94a3b8;
        --success: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
      }

      * {
        box-sizing: border-box;
      }

      body {
        background: var(--bg-deep);
        color: var(--text);
        font-family: 'Inter', sans-serif;
        min-height: 100vh;
        overflow-x: hidden;
        padding-top: 90px;
      }

      /* Animated Background */
      .ambient-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
        overflow: hidden;
      }

      .ambient-bg::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: 
          radial-gradient(circle at 20% 30%, rgba(99, 102, 241, 0.15) 0%, transparent 40%),
          radial-gradient(circle at 80% 70%, rgba(139, 92, 246, 0.12) 0%, transparent 40%),
          radial-gradient(circle at 50% 50%, rgba(6, 182, 212, 0.08) 0%, transparent 50%);
        animation: ambientMove 20s ease-in-out infinite;
      }

      @keyframes ambientMove {
        0%, 100% { transform: translate(0, 0) rotate(0deg); }
        33% { transform: translate(2%, 2%) rotate(120deg); }
        66% { transform: translate(-1%, 1%) rotate(240deg); }
      }

      /* Floating Particles */
      .particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
        overflow: hidden;
      }

      .particle {
        position: absolute;
        width: 4px;
        height: 4px;
        background: rgba(99, 102, 241, 0.4);
        border-radius: 50%;
        animation: float 15s infinite;
        box-shadow: 0 0 10px rgba(99, 102, 241, 0.6);
      }

      @keyframes float {
        0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
        10% { opacity: 1; }
        90% { opacity: 1; }
        100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
      }

      /* Glassmorphism Navbar */
      .nav-glass {
        background: rgba(10, 10, 15, 0.8);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border-bottom: 1px solid var(--glass-border);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
      }

      .nav-link {
        position: relative;
        padding: 8px 16px;
        border-radius: 12px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        font-weight: 500;
        color: var(--text-muted);
      }

      .nav-link::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: 12px;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .nav-link:hover {
        color: var(--text);
        transform: translateY(-2px);
      }

      .nav-link:hover::before {
        opacity: 1;
      }

      .nav-link.active {
        color: var(--primary);
        background: rgba(99, 102, 241, 0.1);
      }

      /* Panic Button */
      .panic-button {
        background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 50px;
        font-weight: 700;
        font-size: 13px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 
          0 4px 20px rgba(220, 38, 38, 0.4),
          0 0 0 1px rgba(255, 255, 255, 0.1) inset;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        position: relative;
        overflow: hidden;
      }

      .panic-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s ease;
      }

      .panic-button:hover::before {
        left: 100%;
      }

      .panic-button:hover {
        transform: scale(1.05) translateY(-2px);
        box-shadow: 
          0 8px 30px rgba(220, 38, 38, 0.6),
          0 0 0 1px rgba(255, 255, 255, 0.2) inset;
      }

      .panic-button:active {
        transform: scale(0.98);
      }

      .panic-button i {
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.8; transform: scale(1.1); }
      }

      /* Header Section */
      .header-section {
        text-align: center;
        padding: 3rem 1rem;
        position: relative;
      }

      .header-title {
        font-family: 'Space Grotesk', sans-serif;
        font-size: clamp(2.5rem, 8vw, 4.5rem);
        font-weight: 800;
        background: linear-gradient(135deg, #fff 0%, #a5b4fc 50%, #818cf8 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 0 60px rgba(99, 102, 241, 0.3);
        letter-spacing: -0.02em;
        position: relative;
      }

      .header-title::after {
        content: 'FATE V3 Games';
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        background: linear-gradient(135deg, #fff 0%, #a5b4fc 50%, #818cf8 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        filter: blur(30px);
        opacity: 0.5;
        z-index: -1;
      }

      .header-subtitle {
        color: var(--text-muted);
        font-size: 1rem;
        margin-top: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .header-subtitle::before,
      .header-subtitle::after {
        content: '';
        width: 40px;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--primary), transparent);
      }

      /* Search Section */
      .search-container {
        position: relative;
        max-width: 600px;
        margin: 0 auto 2rem;
      }

      .search-input-wrapper {
        position: relative;
        background: var(--glass);
        backdrop-filter: blur(10px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 4px;
        transition: all 0.3s ease;
      }

      .search-input-wrapper:focus-within {
        border-color: rgba(99, 102, 241, 0.5);
        box-shadow: 
          0 0 0 3px rgba(99, 102, 241, 0.1),
          0 10px 40px rgba(99, 102, 241, 0.15);
      }

      .search-input {
        width: 100%;
        padding: 16px 24px;
        padding-right: 120px;
        background: transparent;
        border: none;
        color: var(--text);
        font-size: 1rem;
        outline: none;
        border-radius: 16px;
      }

      .search-input::placeholder {
        color: var(--text-muted);
      }

      .search-actions {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .cache-badge {
        font-size: 10px;
        padding: 4px 10px;
        border-radius: 20px;
        background: rgba(16, 185, 129, 0.15);
        color: var(--success);
        border: 1px solid rgba(16, 185, 129, 0.3);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .search-spinner {
        color: var(--primary);
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      /* Stats Bar */
      .stats-bar {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 2rem;
        padding: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }

      .stat-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-muted);
        font-size: 0.875rem;
      }

      .stat-item i {
        color: var(--primary);
      }

      .refresh-btn {
        padding: 6px 14px;
        border-radius: 20px;
        background: rgba(99, 102, 241, 0.1);
        border: 1px solid rgba(99, 102, 241, 0.3);
        color: var(--primary);
        font-size: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .refresh-btn:hover {
        background: rgba(99, 102, 241, 0.2);
        transform: translateY(-1px);
      }

      /* Game Grid */
      .game-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: 1.25rem;
        padding: 0 1rem;
      }

      @media (min-width: 640px) {
        .game-grid {
          grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        }
      }

      @media (min-width: 1024px) {
        .game-grid {
          grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        }
      }

      /* Game Card */
      .game-card {
        position: relative;
        background: var(--glass);
        backdrop-filter: blur(10px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        overflow: hidden;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        transform-style: preserve-3d;
      }

      .game-card::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), transparent);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 1;
        pointer-events: none;
      }

      .game-card:hover {
        transform: translateY(-8px) scale(1.02);
        border-color: rgba(99, 102, 241, 0.3);
        box-shadow: 
          0 20px 40px rgba(0, 0, 0, 0.4),
          0 0 40px rgba(99, 102, 241, 0.15);
      }

      .game-card:hover::before {
        opacity: 1;
      }

      .game-image-container {
        position: relative;
        aspect-ratio: 1;
        overflow: hidden;
        background: linear-gradient(135deg, #1a1a2e, #0f0f1a);
      }

      .game-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .game-card:hover .game-image {
        transform: scale(1.1);
      }

      .game-image-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(to top, rgba(10, 10, 15, 0.9) 0%, transparent 50%);
        opacity: 0;
        transition: opacity 0.3s ease;
        display: flex;
        align-items: flex-end;
        justify-content: center;
        padding-bottom: 1rem;
      }

      .game-card:hover .game-image-overlay {
        opacity: 1;
      }

      .play-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.25rem;
        box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        transform: translateY(20px);
        opacity: 0;
        transition: all 0.3s ease;
      }

      .game-card:hover .play-btn {
        transform: translateY(0);
        opacity: 1;
      }

      /* Badges */
      .badges-container {
        position: absolute;
        top: 12px;
        left: 12px;
        display: flex;
        flex-direction: column;
        gap: 6px;
        z-index: 2;
      }

      .badge {
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 10px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: flex;
        align-items: center;
        gap: 4px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      .badge-hot {
        background: linear-gradient(135deg, rgba(239, 68, 68, 0.9), rgba(220, 38, 38, 0.9));
        color: white;
      }

      .badge-new {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.9), rgba(5, 150, 105, 0.9));
        color: white;
      }

      .badge-exp {
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.9), rgba(217, 119, 6, 0.9));
        color: white;
      }

      .badge-updated {
        background: linear-gradient(135deg, rgba(6, 182, 212, 0.9), rgba(8, 145, 178, 0.9));
        color: white;
      }

      /* Game Info */
      .game-info {
        padding: 1rem;
        background: rgba(0, 0, 0, 0.3);
      }

      .game-name {
        font-weight: 600;
        font-size: 0.9rem;
        text-align: center;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        color: var(--text);
      }

      /* Skeleton Loader */
      .skeleton-card {
        background: var(--glass);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        overflow: hidden;
      }

      .skeleton-image {
        aspect-ratio: 1;
        background: linear-gradient(90deg, #1a1a2e 25%, #252538 50%, #1a1a2e 75%);
        background-size: 200% 100%;
        animation: shimmer 1.5s infinite;
      }

      .skeleton-text {
        height: 20px;
        margin: 1rem;
        border-radius: 8px;
        background: linear-gradient(90deg, #1a1a2e 25%, #252538 50%, #1a1a2e 75%);
        background-size: 200% 100%;
        animation: shimmer 1.5s infinite;
      }

      @keyframes shimmer {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
      }

      /* Empty State */
      .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        color: var(--text-muted);
      }

      .empty-state i {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      /* Load More Button */
      .load-more-container {
        text-align: center;
        padding: 3rem 1rem;
      }

      .load-more-btn {
        padding: 14px 32px;
        border-radius: 30px;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
        border: 1px solid rgba(99, 102, 241, 0.3);
        color: var(--text);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 10px;
      }

      .load-more-btn:hover {
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.3), rgba(139, 92, 246, 0.3));
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(99, 102, 241, 0.2);
      }

      .load-more-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      /* Game Popup */
      .game-popup-overlay {
        position: fixed;
        inset: 0;
        background: rgba(10, 10, 15, 0.95);
        backdrop-filter: blur(10px);
        z-index: 9998;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      .game-popup-container {
        width: 100%;
        max-width: 1400px;
        height: 90vh;
        background: rgba(15, 15, 25, 0.95);
        border-radius: 24px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        border: 1px solid var(--glass-border);
        box-shadow: 
          0 25px 50px rgba(0, 0, 0, 0.5),
          0 0 0 1px rgba(99, 102, 241, 0.1) inset;
        animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      @keyframes slideUp {
        from { 
          opacity: 0;
          transform: translateY(30px) scale(0.98);
        }
        to { 
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .game-popup-header {
        padding: 16px 24px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: rgba(0, 0, 0, 0.3);
        border-bottom: 1px solid var(--glass-border);
      }

      .game-popup-title {
        font-family: 'Space Grotesk', sans-serif;
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text);
        flex: 1;
        text-align: center;
        padding: 0 1rem;
      }

      .game-popup-actions {
        display: flex;
        gap: 10px;
      }

      .popup-btn {
        width: 42px;
        height: 42px;
        border-radius: 12px;
        background: var(--glass);
        border: 1px solid var(--glass-border);
        color: var(--text);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        font-size: 1rem;
      }

      .popup-btn:hover {
        background: rgba(99, 102, 241, 0.2);
        border-color: rgba(99, 102, 241, 0.4);
        transform: scale(1.05);
      }

      .popup-btn.close:hover {
        background: rgba(239, 68, 68, 0.2);
        border-color: rgba(239, 68, 68, 0.4);
      }

      .game-popup-content {
        flex: 1;
        position: relative;
        background: #000;
      }

      .game-popup-content iframe {
        width: 100%;
        height: 100%;
        border: none;
      }

      /* Warning Modal */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(10, 10, 15, 0.9);
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 20px;
      }

      .modal-content {
        background: rgba(15, 15, 25, 0.95);
        border: 1px solid var(--glass-border);
        border-radius: 24px;
        padding: 2rem;
        max-width: 420px;
        width: 100%;
        text-align: center;
        animation: modalPop 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      @keyframes modalPop {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .modal-icon {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1.5rem;
        font-size: 1.75rem;
        color: var(--primary);
        border: 1px solid rgba(99, 102, 241, 0.3);
      }

      .modal-title {
        font-family: 'Space Grotesk', sans-serif;
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 0.75rem;
        color: var(--text);
      }

      .modal-text {
        color: var(--text-muted);
        margin-bottom: 1.5rem;
        line-height: 1.6;
      }

      .modal-btn {
        padding: 12px 32px;
        border-radius: 30px;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        border: none;
        color: white;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
      }

      .modal-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 35px rgba(99, 102, 241, 0.4);
      }

      /* Footer */
      .footer {
        margin-top: 4rem;
        padding: 2rem;
        text-align: center;
        border-top: 1px solid var(--glass-border);
      }

      .visitor-counter {
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
        padding: 1rem 1.5rem;
        background: var(--glass);
        border: 1px solid var(--glass-border);
        border-radius: 16px;
        margin-bottom: 1rem;
      }

      .visitor-counter i {
        color: var(--primary);
      }

      .footer-text {
        color: var(--text-muted);
        font-size: 0.875rem;
      }

      .heart {
        color: var(--danger);
        animation: heartbeat 1.5s infinite;
        display: inline-block;
      }

      @keyframes heartbeat {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
      }

      /* Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: var(--bg-deep);
      }

      ::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, var(--primary), var(--secondary));
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, var(--secondary), var(--primary));
      }

      /* Mobile Responsive */
      @media (max-width: 640px) {
        .panic-button span {
          display: none;
        }
        
        .panic-button {
          padding: 10px;
        }

        .game-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 0.75rem;
          padding: 0 0.5rem;
        }

        .nav-link span {
          display: none;
        }

        .header-title {
          font-size: 2rem;
        }

        .game-popup-container {
          height: 100vh;
          border-radius: 0;
        }

        .game-popup-overlay {
          padding: 0;
        }
      }

      /* Category Pills */
      .category-pills {
        display: flex;
        gap: 0.5rem;
        overflow-x: auto;
        padding: 0.5rem 1rem;
        margin-bottom: 1.5rem;
        scrollbar-width: none;
        -ms-overflow-style: none;
      }

      .category-pills::-webkit-scrollbar {
        display: none;
      }

      .category-pill {
        padding: 8px 18px;
        border-radius: 30px;
        background: var(--glass);
        border: 1px solid var(--glass-border);
        color: var(--text-muted);
        font-size: 0.85rem;
        font-weight: 500;
        cursor: pointer;
        white-space: nowrap;
        transition: all 0.3s ease;
      }

      .category-pill:hover {
        background: rgba(99, 102, 241, 0.1);
        border-color: rgba(99, 102, 241, 0.3);
        color: var(--text);
      }

      .category-pill.active {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        border-color: transparent;
        color: white;
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
      }
    </style>
  </head>

  <body x-data="gamesApp()" x-init="init()">
    <!-- Ambient Background -->
    <div class="ambient-bg"></div>
    <div class="particles" id="particles"></div>

    <!-- Navigation Bar -->
    <nav class="nav-glass fixed top-0 left-0 right-0 z-50 px-4 sm:px-6 py-3">
      <div class="max-w-7xl mx-auto flex justify-between items-center">
        <div class="flex items-center gap-3">
          <button class="panic-button" onclick="window.location.href='https://clever.com'" title="Emergency Exit - Go to Clever">
            <i class="fas fa-exclamation-triangle"></i>
            <span>Panic</span>
          </button>
          
          <div class="flex items-center gap-3 border-l border-gray-700/50 pl-4">
            <img src="media/logo.svg" alt="FATE V3" class="w-10 h-10" style="filter: drop-shadow(0 0 15px rgba(99, 102, 241, 0.5));">
            <span class="text-xl font-bold hidden sm:block" style="font-family: 'Space Grotesk', sans-serif;">FATE V3</span>
          </div>
        </div>
        
        <div class="flex gap-2 sm:gap-4 items-center">
          <a href="index.html" class="nav-link">
            <i class="fas fa-home"></i>
            <span class="hidden sm:inline ml-2">Home</span>
          </a>
          <a href="https://fatev2.vercel.app/apps.html" class="nav-link">
            <i class="fas fa-th-large"></i>
            <span class="hidden sm:inline ml-2">Apps</span>
          </a>
          <a href="https://discord.gg/MfEnRxxxA" target="_blank" class="nav-link">
            <i class="fab fa-discord"></i>
            <span class="hidden sm:inline ml-2">Discord</span>
          </a>
        </div>
      </div>
    </nav>

    <!-- Header Section -->
    <header class="header-section">
      <h1 class="header-title">FATE V3 Games</h1>
      <p class="header-subtitle">FATE Browser is coming soon, you can watch TikTok on it</p>
    </header>

    <main class="container mx-auto max-w-7xl px-4">
      <!-- Search Section -->
      <div class="search-container">
        <div class="search-input-wrapper">
          <input
            type="text"
            x-model="searchQuery"
            @input="debouncedSearch()"
            :placeholder="searchPlaceholder"
            class="search-input"
          />
          <div class="search-actions">
            <span x-show="usingCache" class="cache-badge" x-transition>CACHED</span>
            <i x-show="isSearching" class="fas fa-spinner search-spinner"></i>
            <i x-show="!isSearching && !usingCache" class="fas fa-search text-gray-500"></i>
          </div>
        </div>
      </div>

      <!-- Category Pills -->
      <div class="category-pills">
        <button 
          class="category-pill" 
          :class="{ 'active': activeFilter === 'all' }"
          @click="setFilter('all')"
        >
          <i class="fas fa-th-large mr-1"></i> All Games
        </button>
        <button 
          class="category-pill" 
          :class="{ 'active': activeFilter === 'hot' }"
          @click="setFilter('hot')"
        >
          <i class="fas fa-fire mr-1"></i> Hot
        </button>
        <button 
          class="category-pill" 
          :class="{ 'active': activeFilter === 'new' }"
          @click="setFilter('new')"
        >
          <i class="fas fa-sparkles mr-1"></i> New
        </button>
        <button 
          class="category-pill" 
          :class="{ 'active': activeFilter === 'exp' }"
          @click="setFilter('exp')"
        >
          <i class="fas fa-vial mr-1"></i> Experimental
        </button>
      </div>

      <!-- Stats Bar -->
      <div class="stats-bar">
        <div class="stat-item">
          <i class="fas fa-gamepad"></i>
          <span x-text="filteredGames.length + ' games available'"></span>
        </div>
        <button @click="clearCache()" class="refresh-btn" x-show="usingCache" x-transition>
          <i class="fas fa-sync-alt"></i> Refresh Data
        </button>
      </div>

      <!-- Loading State -->
      <div x-show="loading" class="game-grid">
        <template x-for="i in 12">
          <div class="skeleton-card">
            <div class="skeleton-image"></div>
            <div class="skeleton-text"></div>
          </div>
        </template>
      </div>

      <!-- Empty State -->
      <div
        x-show="!loading && filteredGames.length === 0"
        class="empty-state"
        x-transition
      >
        <i class="fas fa-ghost"></i>
        <h3 class="text-xl font-semibold mb-2">No games found</h3>
        <p>Try adjusting your search or filter</p>
      </div>

      <!-- Games Grid -->
      <div
        x-show="!loading && filteredGames.length > 0"
        class="game-grid"
        id="gamesGrid"
      >
        <template x-for="(game, index) in visibleGames" :key="game.id || index">
          <div
            class="game-card"
            :data-index="index"
            :id="'game-' + index"
            @click="openGame(game)"
          >
            <div class="game-image-container">
              <img
                :data-src="getGameImage(game)"
                :alt="game.name"
                class="game-image"
                loading="lazy"
                @load="$event.target.classList.remove('loading')"
              />
              <div class="game-image-overlay">
                <div class="play-btn">
                  <i class="fas fa-play"></i>
                </div>
              </div>
              
              <div class="badges-container">
                <span x-show="game.top" class="badge badge-hot">
                  <i class="fas fa-fire"></i> HOT
                </span>
                <span x-show="game.new" class="badge badge-new">
                  <i class="fas fa-sparkles"></i> NEW
                </span>
                <span x-show="game.exp" class="badge badge-exp">
                  <i class="fas fa-vial"></i> EXP
                </span>
                <span x-show="game.updated" class="badge badge-updated">
                  <i class="fas fa-sync"></i> UPD
                </span>
              </div>
            </div>

            <div class="game-info">
              <p class="game-name" x-text="game.name"></p>
            </div>
          </div>
        </template>
      </div>

      <!-- Load More -->
      <div x-show="hasMoreGames" class="load-more-container" id="loadMoreTrigger">
        <button 
          @click="loadMore()" 
          class="load-more-btn"
          :disabled="loadingMore"
        >
          <i x-show="loadingMore" class="fas fa-spinner fa-spin"></i>
          <span x-text="loadingMore ? 'Loading...' : 'Load More Games'"></span>
        </button>
      </div>
    </main>

    <!-- Game Popup -->
    <div
      class="game-popup-overlay"
      x-show="popupOpen"
      @click.self="closePopup()"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100"
      x-transition:leave="transition ease-in duration-200"
      x-transition:leave-start="opacity-100"
      x-transition:leave-end="opacity-0"
    >
      <div class="game-popup-container">
        <div class="game-popup-header">
          <div style="width: 94px;"></div>
          <div class="game-popup-title" x-text="currentGame?.name || 'Loading...'"></div>
          <div class="game-popup-actions">
            <button class="popup-btn" @click="fullscreenPopup()" title="Fullscreen">
              <i class="fas fa-expand"></i>
            </button>
            <button class="popup-btn close" @click="closePopup()" title="Close">
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
        <div class="game-popup-content">
          <iframe x-ref="gameFrame" allowfullscreen></iframe>
        </div>
      </div>
    </div>

    <!-- Warning Modal -->
    <div
      class="modal-overlay"
      x-show="showWarningModal"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100"
    >
      <div class="modal-content">
        <div class="modal-icon">
          <i class="fas fa-bell"></i>
        </div>
        <h2 class="modal-title">Welcome to FATE V3</h2>
        <p class="modal-text">
          Remember to sync periodically to keep the games list updated and ensure all games continue working properly.
        </p>
        <button
          @click="showWarningModal = false; localStorage.setItem('warningModalShown', 'true');"
          class="modal-btn"
        >
          Got it!
        </button>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="visitor-counter">
        <i class="fas fa-users"></i>
        <span>Total Visitors:</span>
        <a href='https://www.free-counters.org/' style="display: none;">Counter</a>
        <script type='text/javascript' src='https://www.freevisitorcounters.com/auth.php?id=aac3697a17827feb76b9c30b1d439798f92b3329'></script>
        <script type="text/javascript" src="https://www.freevisitorcounters.com/en/home/counter/1486140/t/3"></script>
      </div>
      <p class="footer-text">FATE V3 - Made with <span class="heart">❤️</span></p>
    </footer>

    <script>
      // Create floating particles
      function createParticles() {
        const container = document.getElementById('particles');
        const particleCount = 20;
        
        for (let i = 0; i < particleCount; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';
          particle.style.left = Math.random() * 100 + '%';
          particle.style.animationDelay = Math.random() * 15 + 's';
          particle.style.animationDuration = (15 + Math.random() * 10) + 's';
          container.appendChild(particle);
        }
      }
      
      createParticles();

      const cdnUrl = "https://mathcenter.space";
      const cdnUrl2 = "https://corsproxy.io/?url=";
      const CACHE_KEY = 'fate_games_cache';
      const CACHE_DURATION = 1000 * 60 * 30;
      const GAMES_PER_PAGE = 24;

      function gamesApp() {
        return {
          allGames: [],
          filteredGames: [],
          visibleGames: [],
          searchQuery: "",
          searchPlaceholder: "Search for games...",
          loading: true,
          loadingMore: false,
          popupOpen: false,
          currentGame: null,
          showWarningModal: true,
          usingCache: false,
          isSearching: false,
          searchTimeout: null,
          currentPage: 0,
          hasMoreGames: false,
          activeFilter: 'all',
          imageObserver: null,

          async init() {
            this.showWarningModal =
              !window.location.search.includes("nomodal") &&
              !localStorage.getItem("warningModalShown");

            console.log(
              "%cFATE%c V3 - Enhanced Experience",
              "font-size: 16px; background: linear-gradient(135deg, #6366f1, #8b5cf6); border-radius: 8px 0 0 8px; padding: 6px 12px; font-weight: bold; color: white;",
              "font-size: 16px; background: #0a0a0f; font-weight: bold; padding: 6px 12px; border-radius: 0 8px 8px 0; color: #6366f1;"
            );

            this.initImageObserver();
            
            const cached = this.getCachedGames();
            if (cached) {
              this.allGames = cached;
              this.applyFilters();
              this.usingCache = true;
              this.loading = false;
              this.refreshGamesInBackground();
            } else {
              await this.loadGames();
            }

            this.initInfiniteScroll();
          },

          initImageObserver() {
            this.imageObserver = new IntersectionObserver((entries) => {
              entries.forEach(entry => {
                if (entry.isIntersecting) {
                  const img = entry.target;
                  const src = img.getAttribute('data-src');
                  if (src) {
                    const preloadImg = new Image();
                    preloadImg.onload = () => {
                      img.src = src;
                      img.removeAttribute('data-src');
                    };
                    preloadImg.src = src;
                    this.imageObserver.unobserve(img);
                  }
                }
              });
            }, {
              rootMargin: '100px 0px',
              threshold: 0.01
            });
          },

          initInfiniteScroll() {
            const loadMoreTrigger = document.getElementById('loadMoreTrigger');
            if (loadMoreTrigger) {
              const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                  if (entry.isIntersecting && this.hasMoreGames && !this.loadingMore) {
                    this.loadMore();
                  }
                });
              }, { threshold: 0.1 });
              
              observer.observe(loadMoreTrigger);
            }
          },

          getCachedGames() {
            try {
              const cached = localStorage.getItem(CACHE_KEY);
              if (!cached) return null;
              
              const { data, timestamp } = JSON.parse(cached);
              const age = Date.now() - timestamp;
              
              if (age > CACHE_DURATION) {
                localStorage.removeItem(CACHE_KEY);
                return null;
              }
              
              return data;
            } catch (e) {
              console.error('Cache read error:', e);
              return null;
            }
          },

          setCachedGames(data) {
            try {
              const cache = {
                data: data,
                timestamp: Date.now()
              };
              localStorage.setItem(CACHE_KEY, JSON.stringify(cache));
            } catch (e) {
              console.error('Cache write error:', e);
            }
          },

          clearCache() {
            localStorage.removeItem(CACHE_KEY);
            this.usingCache = false;
            this.loadGames();
          },

          async refreshGamesInBackground() {
            try {
              const freshData = await this.fetchGamesData();
              if (freshData.length > 0) {
                this.allGames = freshData;
                this.applyFilters();
                this.setCachedGames(freshData);
                this.usingCache = false;
              }
            } catch (error) {
              console.error('Background refresh failed:', error);
            }
          },

          async loadGames() {
            this.loading = true;
            try {
              const data = await this.fetchGamesData();
              this.allGames = data;
              this.applyFilters();
              this.setCachedGames(data);
              this.usingCache = false;
            } catch (error) {
              console.error("Error loading games:", error);
              if (this.allGames.length === 0) {
                this.searchPlaceholder = "Failed to load games";
              }
            } finally {
              this.loading = false;
            }
          },

          async fetchGamesData() {
            const timeout = new Promise((_, reject) => 
              setTimeout(() => reject(new Error('Request timeout')), 10000)
            );

            const fetchPromise = Promise.allSettled([
              fetch("./json/games.json").then((r) => r.json()),
              fetch(cdnUrl2 + encodeURIComponent("https://mathcenter.space/cdn/all")).then((r) => r.json()),
            ]);

            const responses = await Promise.race([fetchPromise, timeout]);
            
            const games = responses
              .filter((r) => r.status === "fulfilled")
              .flatMap((r) => r.value);

            return games.map((game, index) => ({
              ...game,
              id: game.id || `game-${index}-${Date.now()}`
            }));
          },

          setFilter(filter) {
            this.activeFilter = filter;
            this.applyFilters();
          },

          debouncedSearch() {
            this.isSearching = true;
            clearTimeout(this.searchTimeout);
            this.searchTimeout = setTimeout(() => {
              this.applyFilters();
              this.isSearching = false;
            }, 300);
          },

          applyFilters() {
            let filtered = this.allGames;

            // Category filter
            if (this.activeFilter !== 'all') {
              filtered = filtered.filter(game => game[this.activeFilter] === true);
            }

            // Search filter
            if (this.searchQuery) {
              const query = this.searchQuery.toLowerCase();
              filtered = filtered.filter((game) =>
                game.name.toLowerCase().includes(query)
              );
            }

            // Sort
            filtered = [...filtered].sort((a, b) => {
              if (a.name === "Request a game") return -1;
              if (b.name === "Request a game") return 1;
              if (a.new && !b.new) return -1;
              if (!a.new && b.new) return 1;
              if (a.top && !b.top) return -1;
              if (!a.top && b.top) return 1;
              return 0;
            });

            this.filteredGames = filtered;
            this.currentPage = 0;
            this.updateVisibleGames();
            this.searchPlaceholder = `Search ${filtered.length} game${filtered.length !== 1 ? "s" : ""}...`;
          },

          updateVisibleGames() {
            const start = 0;
            const end = (this.currentPage + 1) * GAMES_PER_PAGE;
            this.visibleGames = this.filteredGames.slice(start, end);
            this.hasMoreGames = end < this.filteredGames.length;
            
            this.$nextTick(() => {
              this.observeImages();
            });
          },

          observeImages() {
            const images = document.querySelectorAll('img[data-src]');
            images.forEach(img => this.imageObserver.observe(img));
          },

          loadMore() {
            if (this.loadingMore || !this.hasMoreGames) return;
            this.loadingMore = true;
            
            setTimeout(() => {
              this.currentPage++;
              const start = this.currentPage * GAMES_PER_PAGE;
              const end = start + GAMES_PER_PAGE;
              const newGames = this.filteredGames.slice(start, end);
              this.visibleGames = [...this.visibleGames, ...newGames];
              this.hasMoreGames = end < this.filteredGames.length;
              this.loadingMore = false;
              
              this.$nextTick(() => {
                this.observeImages();
              });
            }, 150);
          },

          getGameImage(game) {
            if (game.image?.startsWith("https://")) {
              return game.image;
            }
            if (game.proxy) {
              return cdnUrl + `/media/games/${game.image}`;
            } else {
              const firstSegment = game.url?.split("/")[0] || "";
              return cdnUrl + `/cdn/${firstSegment}/${game.image}`;
            }
          },

          async openGame(game) {
            this.currentGame = game;
            this.popupOpen = true;

            await this.$nextTick();
            const iframe = this.$refs.gameFrame;

            if (game.url?.includes("jsdelivr")) {
              try {
                const response = await fetch(game.url);
                const html = await response.text();
                iframe.contentDocument.open();
                iframe.contentDocument.write(html);
                iframe.contentDocument.close();
              } catch (error) {
                console.error("Error loading jsdelivr content:", error);
              }
            } else if (!game.proxy) {
              iframe.src = cdnUrl + `/cdn/${game.url}/`;
            } else {
              iframe.src = game.url;
            }
          },

          closePopup() {
            this.popupOpen = false;
            this.currentGame = null;

            const iframe = this.$refs.gameFrame;
            if (iframe) {
              iframe.src = "about:blank";
            }
          },

          fullscreenPopup() {
            const iframe = this.$refs.gameFrame;
            if (iframe.requestFullscreen) {
              iframe.requestFullscreen();
            } else if (iframe.mozRequestFullScreen) {
              iframe.mozRequestFullScreen();
            } else if (iframe.webkitRequestFullscreen) {
              iframe.webkitRequestFullscreen();
            } else if (iframe.msRequestFullscreen) {
              iframe.msRequestFullscreen();
            }
          },
        };
      }
    </script>
  </body>
</html>
